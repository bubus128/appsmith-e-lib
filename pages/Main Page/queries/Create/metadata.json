{
  "pluginType": "DB",
  "pluginId": "postgres-plugin",
  "unpublishedAction": {
    "name": "Create",
    "datasource": {
      "name": "books",
      "pluginId": "postgres-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "books",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "Main Page",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "CREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- Dropping old tables if they exist\nDROP TABLE IF EXISTS\n  BooksRent, MoviesRent, AudiobookRents,\n  ActorsInFilm, ScreenwriterFilm, FilmDirection,\n  Actors, Directors, Screenwriters,\n  Authorship, MovieCopies, BookCopies, Audiobooks, Books,\n  Movies, Categories, Authors, Persons, Users;\n\nCREATE TABLE Users (\n\tuser_id SERIAL PRIMARY KEY,\n\tusername VARCHAR(255) NOT NULL UNIQUE,\n\tpassword_hash VARCHAR(64) NOT NULL,\n\tsalt VARCHAR(32) NOT NULL,\n\trol VARCHAR(32) DEFAULT 'customer'\n);\n\n-- Creating Persons table\nCREATE TABLE Persons (\n\tID SERIAL PRIMARY KEY,\n\tLastName VARCHAR(255),\n\tFirstName VARCHAR(255)\n);\n\n-- Creating Authors table\nCREATE TABLE Authors (\n\tID SERIAL PRIMARY KEY,\n\tPersonID INT REFERENCES Persons(ID)\n);\n\n-- Creating Categories table\nCREATE TABLE Categories (\n\tID SERIAL PRIMARY KEY,\n\tName VARCHAR(255)\n);\n\n-- Creating Movies table\nCREATE TABLE Movies (\n\tID SERIAL PRIMARY KEY,\n\tTitle VARCHAR(255),\n\tDuration INT,\n\tCategoryID INT REFERENCES Categories(ID),\n\tAccepted BOOLEAN DEFAULT FALSE\n);\n\n-- Creating Directors table\nCREATE TABLE Directors (\n\tID SERIAL PRIMARY KEY,\n\tPersonID INT REFERENCES Persons(ID)\n);\n\n-- Creating Screenwriters table\nCREATE TABLE Screenwriters (\n\tID SERIAL PRIMARY KEY,\n\tPersonID INT REFERENCES Persons(ID)\n);\n\n-- Creating Actors table\nCREATE TABLE Actors (\n\tID SERIAL PRIMARY KEY,\n\tPersonID INT REFERENCES Persons(ID)\n);\n\n-- Creating ActorsInFilm table\nCREATE TABLE ActorsInFilm (\n\tID SERIAL PRIMARY KEY,\n\tActorID INT REFERENCES Actors(ID),\n\tFilmID INT REFERENCES Movies(ID)\n);\n\n-- Creating FilmDirection table\nCREATE TABLE FilmDirection (\n\tID SERIAL PRIMARY KEY,\n\tDirectorID INT REFERENCES Directors(ID),\n\tFilmID INT REFERENCES Movies(ID)\n);\n\n-- Creating ScreenwriterFilm table\nCREATE TABLE ScreenwriterFilm (\n\tID SERIAL PRIMARY KEY,\n\tScreenwriterID INT REFERENCES Screenwriters(ID),\n\tFilmID INT REFERENCES Movies(ID)\n);\n\n-- Creating Books table\nCREATE TABLE Books (\n\tID SERIAL PRIMARY KEY,\n\tAuthor VARCHAR(255),\n\tTitle VARCHAR(255),\n\tAccepted BOOLEAN DEFAULT FALSE\n);\n\n-- Creating BookCopies table\nCREATE TABLE BookCopies (\n\tID SERIAL PRIMARY KEY,\n\tBookID INT REFERENCES Books(ID),\n\tReleaseYear INT,\n\tAvailable BOOLEAN,\n\tAccepted BOOLEAN DEFAULT FALSE\n);\n\n-- Creating Audiobooks table\nCREATE TABLE Audiobooks (\n\tID SERIAL PRIMARY KEY,\n\tBookID INT REFERENCES Books(ID),\n\tAvailable BOOLEAN,\n\tAccepted BOOLEAN DEFAULT FALSE\n);\n\n-- Creating Authorship table\nCREATE TABLE Authorship (\n\tID SERIAL PRIMARY KEY,\n\tAuthorID INT REFERENCES Authors(ID),\n\tBookID INT REFERENCES Books(ID)\n);\n\n-- Creating MovieCopies table\nCREATE TABLE MovieCopies (\n\tID SERIAL PRIMARY KEY,\n\tMovieID INT REFERENCES Movies(ID),\n\tReleaseYear INT,\n\tAvailable BOOLEAN,\n\tAccepted BOOLEAN DEFAULT FALSE\n);\n\n-- Dodanie tabeli reprezentującej wypożyczone kopie książek przez użytkowników\nCREATE TABLE BooksRent (\n\tRentID SERIAL PRIMARY KEY,\n\tUserID INT REFERENCES Users(user_id),\n\tBookCopyID INT REFERENCES BookCopies(ID),\n\tRentDate DATE DEFAULT CURRENT_DATE,\n\tReturnDate DATE DEFAULT NULL,\n\tReturned BOOLEAN DEFAULT FALSE\n);\n\n-- Dodanie tabeli reprezentującej wypożyczone kopie filmów przez użytkowników\nCREATE TABLE MoviesRent (\n\tRentID SERIAL PRIMARY KEY,\n\tUserID INT REFERENCES Users(user_id),\n\tMovieCopyID INT REFERENCES MovieCopies(ID),\n\tRentDate DATE DEFAULT CURRENT_DATE,\n\tReturnDate DATE DEFAULT NULL,\n\tReturned BOOLEAN DEFAULT FALSE\n);\n\n-- Dodanie tabeli reprezentującej wypożyczone audiobooki przez użytkowników\nCREATE TABLE AudiobookRents (\n\tRentID SERIAL PRIMARY KEY,\n\tUserID INT REFERENCES Users(user_id),\n\tAudiobookID INT REFERENCES Audiobooks(ID),\n\tRentDate DATE DEFAULT CURRENT_DATE,\n\tReturnDate DATE DEFAULT NULL,\n\tReturned BOOLEAN DEFAULT FALSE\n);",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": false,
    "dynamicBindingPathList": [],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": [],
    "createdAt": "2023-12-17T09:37:46Z"
  },
  "id": "Main Page_Create",
  "deleted": false,
  "gitSyncId": "657ebe805e703460a35a6912_657ec1415e703460a35a6938"
}